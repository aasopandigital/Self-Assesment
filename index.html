<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Ujian Bahasa Inggris</title>

<style>
body { font-family: Arial; max-width: 900px; margin: auto; padding: 20px; }
.hidden { display:none; }
#timer { color:red; font-weight:bold; margin-bottom:15px; }
.question { margin-bottom:18px; }
.passage {
  background:#f4f4f4;
  padding:15px;
  margin:25px 0;
  border-left:5px solid #333;
}
button { padding:10px 20px; font-size:16px; cursor:pointer; }
</style>
</head>

<body>

<h2>Ujian Bahasa Inggris</h2>

<!-- LOGIN -->
<div id="login">
  <p>Masukkan nama sebelum mulai:</p>
  <input type="text" id="nama">
  <br><br>
  <button onclick="start()">MULAI UJIAN</button>
</div>

<!-- QUIZ -->
<div id="quiz" class="hidden">
  <div id="timer"></div>
  <div id="questions"></div>
</div>

<script>
let waktu = 3600;
let timerInterval;

/* ===== START ===== */
function start(){
  if(!nama.value.trim()){
    alert("Masukkan nama terlebih dahulu!");
    return;
  }
  localStorage.setItem("examStarted","yes");
  login.style.display="none";
  quiz.classList.remove("hidden");
  renderQuestions();
  startTimer();
}

/* ===== TIMER ===== */
function startTimer(){
  timerInterval = setInterval(()=>{
    let m = Math.floor(waktu/60);
    let s = waktu%60;
    timer.innerText = `Sisa waktu: ${m}:${s<10?"0":""}${s}`;
    waktu--;
    if(waktu<0) selesai();
  },1000);
}

/* ===== DATA ===== */
const passages = [
{
text: `
<b>TEXT 1</b><br><br>
<b>Paragraph 1:</b> Students have different learning styles that influence how effectively they understand new information. Some learners prefer visual materials such as diagrams and charts, while others learn better through listening and discussion.<br><br>
<b>Paragraph 2:</b> When students understand their own learning preferences, they are able to choose strategies that suit them best. This awareness helps them study more efficiently and manage their time more wisely.<br><br>
<b>Paragraph 3:</b> Students who ignore their learning styles often experience frustration. They may spend long hours studying without achieving satisfactory results because the methods they use do not match their needs.<br><br>
<b>Paragraph 4:</b> Therefore, recognizing individual learning styles is essential for academic success, as it enables students to maximize their potential.
`,
questions:[
{q:"The main idea of the text is about…",o:["learning failure","learning styles","school rules","technology","exams"],a:1},
{q:"Students learn more effectively when they…",o:["copy others","study longer","know their style","avoid planning","use one method"],a:2},
{q:"Frustration occurs because students…",o:["lack teachers","use wrong strategies","are lazy","study less","fail exams"],a:1},
{q:"The tone of the text is…",o:["emotional","informative","angry","negative","sarcastic"],a:1},
{q:"Which conclusion best fits the text?",o:["Learning styles are fixed","All students are the same","Self-awareness improves learning","Teachers are unimportant","Time is irrelevant"],a:2}
]
},

{
text: `
<b>TEXT 2</b><br><br>
<b>Paragraph 1:</b> Technology has transformed modern education by providing flexible access to information anytime and anywhere.<br><br>
<b>Paragraph 2:</b> However, excessive reliance on technology may weaken students’ critical thinking skills, as learners become dependent on digital tools.<br><br>
<b>Paragraph 3:</b> When learners stop questioning information, their analytical abilities decline significantly, reducing independent reasoning.<br><br>
<b>Paragraph 4:</b> Therefore, technology should support learning rather than replace thinking processes.
`,
questions:[
{q:"The text mainly discusses…",o:["online exams","technology balance","digital failure","teacher roles","student laziness"],a:1},
{q:"Critical thinking decreases when students…",o:["analyze","reflect","depend too much","discuss","write"],a:2},
{q:"The word excessive means…",o:["limited","balanced","too much","careful","controlled"],a:2},
{q:"The writer’s attitude is…",o:["negative","positive","balanced","emotional","unclear"],a:2},
{q:"The best recommendation is to…",o:["avoid technology","replace teachers","use technology wisely","depend fully","ban devices"],a:2}
]
},

{
text: `
<b>TEXT 3</b><br><br>
<b>Paragraph 1:</b> Failure is often seen as something negative in education, causing students to feel discouraged.<br><br>
<b>Paragraph 2:</b> In fact, failure plays an important role in helping learners identify weaknesses and improve strategies.<br><br>
<b>Paragraph 3:</b> Students who reflect on mistakes tend to develop resilience and deeper understanding.<br><br>
<b>Paragraph 4:</b> Thus, failure should be viewed as a valuable learning opportunity.
`,
questions:[
{q:"Failure is described as…",o:["harmful","useless","a learning tool","a punishment","an end"],a:2},
{q:"Students benefit from failure when they…",o:["ignore it","reflect","escape","blame others","avoid risk"],a:1},
{q:"Reflection leads to…",o:["fear","resilience","stress","confusion","delay"],a:1},
{q:"The tone of the text is…",o:["hopeless","constructive","angry","fearful","neutral"],a:1},
{q:"Which statement best summarizes the text?",o:["Failure should be avoided","Failure builds learning","Failure is shameful","Failure ends progress","Failure shows weakness"],a:1}
]
},

{
text: `
<b>TEXT 4</b><br><br>
<b>Paragraph 1:</b> Environmental problems caused by human activities continue to increase worldwide.<br><br>
<b>Paragraph 2:</b> Many environmental damages are irreversible and affect future generations.<br><br>
<b>Paragraph 3:</b> Education plays a crucial role in raising environmental awareness.<br><br>
<b>Paragraph 4:</b> Sustainable development requires responsibility from all parties.
`,
questions:[
{q:"Irreversible means…",o:["temporary","permanent","avoidable","harmless","natural"],a:1},
{q:"The best solution suggested is…",o:["punishment","technology only","education","delay","ignoring"],a:2},
{q:"The main focus of the text is…",o:["economy","industry","sustainability","competition","tradition"],a:2},
{q:"Public awareness is raised through…",o:["rules","fear","education","delay","technology alone"],a:2},
{q:"The text emphasizes…",o:["individual profit","global responsibility","economic growth","politics","competition"],a:1}
]
}
];

/* ===== RENDER ===== */
function renderQuestions(){
  let html="";
  let idx=0;
  passages.forEach(p=>{
    html+=`<div class="passage">${p.text}</div>`;
    p.questions.forEach(q=>{
      html+=`<div class="question"><p>${++idx}. ${q.q}</p>`;
      q.o.forEach((op,i)=>{
        html+=`<label><input type="radio" name="q${idx}" value="${i}"> ${String.fromCharCode(65+i)}. ${op}</label><br>`;
      });
      html+=`</div>`;
    });
  });
  html+=`<button onclick="selesai()">SELESAI UJIAN</button>`;
  questions.innerHTML=html;
}

/* ===== SELESAI ===== */
function selesai(){
  clearInterval(timerInterval);
  localStorage.removeItem("examStarted");
  let score=0, no=0;
  passages.forEach(p=>{
    p.questions.forEach(q=>{
      no++;
      const c=document.querySelector(`input[name="q${no}"]:checked`);
      if(c && +c.value===q.a) score++;
    });
  });
  const fd=new FormData();
  fd.append("nama",nama.value);
  fd.append("skor",score);
  fd.append("total",no);
  fetch("PASTE_URL_WEB_APP_APPS_SCRIPT",{
    method:"POST",body:fd
  }).then(()=>alert("Ujian selesai\nNilai: "+score))
    .then(()=>location.reload());
}

/* ===== RESUME ===== */
if(localStorage.getItem("examStarted")==="yes"){
  login.style.display="none";
  quiz.classList.remove("hidden");
  renderQuestions();
  startTimer();
}
</script>

</body>
</html>
