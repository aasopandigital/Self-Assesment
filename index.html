<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Ujian Bahasa Inggris</title>

<style>
body { font-family: Arial; max-width: 900px; margin: auto; padding: 20px; }
.hidden { display:none; }
#timer { color:red; font-weight:bold; margin-bottom:15px; }
.question { margin-bottom:20px; }
.passage {
  background:#f4f4f4;
  padding:15px;
  margin:25px 0;
  border-left:4px solid #333;
}
button { padding:10px 20px; font-size:16px; cursor:pointer; }
</style>
</head>

<body>

<h2>Ujian Bahasa Inggris</h2>

<div id="login">
  <p>Masukkan nama sebelum mulai:</p>
  <input type="text" id="nama">
  <br><br>
  <button onclick="start()">MULAI UJIAN</button>
</div>

<div id="quiz" class="hidden">
  <div id="timer"></div>
  <div id="questions"></div>
</div>

<script>
/* ================= UTIL ================= */
function shuffle(arr){
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return arr;
}

/* ================= TIMER ================= */
let waktu = 3600;
let timerInterval;

/* ================= START ================= */
function start(){
  if(!nama.value.trim()){ alert("Masukkan nama terlebih dahulu!"); return; }
  document.getElementById("login").style.display="none";
  document.getElementById("quiz").classList.remove("hidden");
  renderQuestions();
  startTimer();
}

function startTimer(){
  timerInterval=setInterval(()=>{
    let m=Math.floor(waktu/60), s=waktu%60;
    timer.innerText=`Sisa waktu: ${m}:${s<10?"0":""}${s}`;
    waktu--;
    if(waktu<0) selesai();
  },1000);
}

/* ================= DATA ================= */
const passages = [
{
title:"TEXT 1",
text:`
Paragraph 1: Learning styles vary significantly among students. Some learners process
information visually, while others rely on auditory or kinesthetic experiences.<br><br>
Paragraph 2: When students are unaware of their learning preferences, they often adopt
inefficient study strategies leading to frustration.<br><br>
Paragraph 3: Understanding learning styles allows learners to maximize strengths and
minimize weaknesses in their academic process.<br><br>
Paragraph 4: Therefore, self-awareness is essential for long-term academic success.
`,
questions:[
{q:"The main idea of the text emphasizes…",o:["Technology","Learning styles","Teachers","Schools","Discipline"],a:1},
{q:"Paragraph 2 implies that students may fail because they…",o:["lack time","lack awareness","lack teachers","lack books","lack rules"],a:1},
{q:"The writer would most likely agree that success depends on…",o:["Luck","Memory","Self-awareness","Competition","Talent"],a:2},
{q:"Which strategy best reflects the text?",o:["Copy others","Self-reflection","Avoid failure","Study longer","Ignore mistakes"],a:1},
{q:"The tone of the text is…",o:["Critical","Informative","Humorous","Sarcastic","Emotional"],a:1},
{q:"Paragraph 3 mainly discusses…",o:["Problems","Effects","Solutions","Examples","Contrasts"],a:2},
{q:"Which conclusion is most logical?",o:["All students are equal","Learning styles matter","Teachers decide success","Grades are absolute","Failure is final"],a:1},
{q:"The purpose of the text is to…",o:["Entertain","Persuade","Explain","Warn","Criticize"],a:2}
]
},

{
title:"TEXT 2",
text:`
Paragraph 1: Technology has transformed modern education by providing flexible access to
information anytime and anywhere.<br><br>
Paragraph 2: However, excessive reliance on technology may weaken students’ critical
thinking skills.<br><br>
Paragraph 3: When learners stop questioning information, their analytical abilities
decline significantly.<br><br>
Paragraph 4: Therefore, technology should support—not replace—thinking processes.
`,
questions:[
{q:"The main topic of the text is…",o:["Education failure","Online schools","Balanced technology","Digital addiction","Teacher roles"],a:2},
{q:"Excessive technology use may reduce…",o:["Access","Speed","Critical thinking","Motivation","Creativity"],a:2},
{q:"Paragraph 3 emphasizes…",o:["Advantages","Risks","Solutions","Examples","Definitions"],a:1},
{q:"The writer’s attitude toward technology is…",o:["Negative","Positive","Balanced","Unclear","Angry"],a:2},
{q:"The word excessive is closest in meaning to…",o:["Limited","Controlled","Too much","Balanced","Minimal"],a:2},
{q:"Which advice best fits the text?",o:["Avoid technology","Use wisely","Depend fully","Study offline only","Ignore apps"],a:1},
{q:"Paragraph 4 serves as a…",o:["Warning","Conclusion","Example","Contrast","Cause"],a:1},
{q:"Which statement is NOT supported?",o:["Technology helps learning","Balance is needed","Apps replace thinking","Critical skills matter","Access is easier"],a:2}
]
},

{
title:"TEXT 3",
text:`
Paragraph 1: Failure is often seen as something negative in academic environments.<br><br>
Paragraph 2: In reality, failure provides important feedback for improvement.<br><br>
Paragraph 3: Students who reflect on failure develop resilience and adaptability.<br><br>
Paragraph 4: Thus, failure should be treated as part of meaningful learning.
`,
questions:[
{q:"Failure is viewed by the writer as…",o:["Harmful","Useless","Beneficial","Embarrassing","Final"],a:2},
{q:"Paragraph 2 suggests failure helps students…",o:["Quit","Improve","Compete","Hide","Relax"],a:1},
{q:"Resilience is developed through…",o:["Success","Luck","Reflection","Discipline","Avoidance"],a:2},
{q:"The tone of the text is…",o:["Fearful","Constructive","Angry","Neutral","Sarcastic"],a:1},
{q:"The main purpose of the text is to…",o:["Warn","Encourage","Criticize","Entertain","Describe"],a:1},
{q:"Paragraph 3 mainly discusses…",o:["Causes","Effects","Definitions","Examples","Warnings"],a:1},
{q:"Which conclusion best fits?",o:["Failure must be avoided","Failure supports learning","Only success matters","Mistakes are shameful","Grades define ability"],a:1}
]
},

{
title:"TEXT 4",
text:`
Paragraph 1: Environmental damage caused by humans often results in irreversible effects.<br><br>
Paragraph 2: Pollution and deforestation accelerate environmental degradation globally.<br><br>
Paragraph 3: Education plays a key role in increasing environmental awareness.<br><br>
Paragraph 4: Sustainable development requires awareness, policy, and collective action.
`,
questions:[
{q:"Irreversible means…",o:["Temporary","Permanent","Repairable","Minor","Natural"],a:1},
{q:"The best solution suggested is…",o:["Ignore issues","Education","Punishment","Technology only","Waiting"],a:1},
{q:"Paragraph 3 emphasizes…",o:["Industry","Education","Economy","Politics","Tradition"],a:1},
{q:"The main theme of the text is…",o:["Business","Culture","Sustainability","Technology","Tourism"],a:2},
{q:"Environmental protection requires…",o:["Individuals only","Government only","Collective effort","Time only","Rules only"],a:2},
{q:"Paragraph 4 functions as a…",o:["Example","Contrast","Conclusion","Definition","Warning"],a:2}
]
}
];

/* ================= RENDER ================= */
function renderQuestions(){
  let html="";
  let no=1;

  passages.forEach(p=>{
    html+=`<div class="passage"><b>${p.title}</b><br><br>${p.text}</div>`;

    shuffle(p.questions);
    p.questions.forEach(q=>{
      q.options=shuffle(q.o.map((t,i)=>({t,idx:i})));
      q.answer=q.options.findIndex(x=>x.idx===q.a);

      html+=`<div class="question"><p>${no}. ${q.q}</p>`;
      q.options.forEach((op,i)=>{
        html+=`<label><input type="radio" name="q${no}" value="${i}">
        ${String.fromCharCode(65+i)}. ${op.t}</label><br>`;
      });
      html+=`</div>`;
      no++;
    });
  });

  html+=`<button onclick="selesai()">SELESAI UJIAN</button>`;
  questions.innerHTML=html;
}

/* ================= SELESAI ================= */
function selesai(){
  clearInterval(timerInterval);
  let score=0;
  let idx=1;

  passages.forEach(p=>{
    p.questions.forEach(q=>{
      const c=document.querySelector(`input[name="q${idx}"]:checked`);
      if(c && +c.value===q.answer) score++;
      idx++;
    });
  });

  const fd=new FormData();
  fd.append("nama",nama.value);
  fd.append("skor",score);
  fd.append("total",30);

  fetch("https://script.google.com/macros/s/AKfycbxEFXvRa3q4qfPyU_q5LnHXtYlH7w3slGKMukQ8DV9RtRxiPY8gIkIJrVtrRdOUQm36TQ/exec",
  {method:"POST",body:fd})
  .then(()=>alert("Ujian selesai\nNilai: "+score))
  .then(()=>location.reload())
  .catch(()=>alert("Gagal mengirim nilai"));
}
</script>

</body>
</html>
